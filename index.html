<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>要約ツール</title>

<style>
    body{
        font-family:sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        margin: 0;
    }
    textarea{
        width: 100%;
        max-width: 600px;
        padding: 5px;
        margin: 5px;
    }
    .result{
        width: 100%;
        height: 100px;
        max-width: 600px;
        border:1px solid #ccc;
        padding: 5px;
        margin: 5px;
        white-space: pre-wrap;
    }
    h1{
        width: 100%;
        max-width: 600px;
        text-align: center;
    }

    button{
      width: 100%;
      max-width: 600px;
      text-align: center;
    }
    
</style>
</head>
<body>
    
<h1>要約ツール</h1>

<p>▼ 要約したい文章を貼り付けてください</p>
<textarea id="inputText" rows="8" placeholder="ここに文章を貼り付けてください"></textarea>

<p>▼ 要約の形式を選んでください</p>
<label>
    <input type="radio" name="mode" value="points" checked>
    要約3行
</label>

<label>
    <input type="radio" name="mode" value="list">
    箇条書き
</label>

<label>
    <input type="radio" name="mode" value="short">
    100字要約
</label>

<p>
<button id="generateBtn">要約する</button>
</p>

<p>結果</p>
<div id="result" class="result"></div>


<script>
  // 新しいAPIキーをここに入れてください
  const API_KEY = "XXXXXXXXXXXXXXXXXXXXXXXXXXX";

  const inputText = document.getElementById("inputText");
  const resultDiv = document.getElementById("result");
  const generateBtn = document.getElementById("generateBtn");
  const copyBtn = document.getElementById("copyBtn");

  generateBtn.addEventListener("click", async function () {
    const text = inputText.value;
    if (!text) {
      alert("文章を入力してください");
      return;
    }

    const mode = document.querySelector('input[name="mode"]:checked').value;

    let instruction = "";
    if (mode === "points") {
      instruction = "以下の文章を要点3行でまとめてください。";
    } else if (mode === "list") {
      instruction = "以下の文章を箇条書きでまとめてください。";
    } else {
      instruction = "以下の文章を100字以内で要約してください。";
    }

    resultDiv.textContent = "生成中…";

    try {
      const response = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${API_KEY}`,
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            contents: [
              {
                parts: [
                  {
                    text: instruction + "\n\n" + text
                  }
                ]
              }
            ]
          })
        }
      );

      if (!response.ok) {
        const errorText = await response.text();
        console.error("API Error:", response.status, errorText);
        resultDiv.textContent = `エラーが発生しました (${response.status})`;
        return;
      }

      const data = await response.json();

      if (!data.candidates || !data.candidates[0]) {
        console.error("Unexpected response:", data);
        resultDiv.textContent = "エラーが発生しました。";
        return;
      }

      const output = data.candidates[0].content.parts[0].text;
      resultDiv.textContent = output;
    } catch (error) {
      console.error("Error:", error);
      resultDiv.textContent = "エラーが発生しました: " + error.message;
    }
  });

</script>

</body>
</html>
